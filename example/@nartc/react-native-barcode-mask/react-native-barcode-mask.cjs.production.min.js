"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react-native"),o=require("react"),n=e(o),i=require("react-native-reanimated"),r=e(i),a=require("react-native-camera");function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e}).apply(this,arguments)}var u=r.Value,c=r.Clock,s=r.block,l=r.cond,h=r.set,f=r.startClock,g=r.timing,m=r.eq,p=function(){},b=o.memo((function(e){var o=e.width,i=e.height,a=e.startValue,u=e.destinationValue,s=e.backgroundColor,l=e.edgeBorderWidth,h=e.edgeColor,f=e.edgeHeight,g=e.edgeWidth,m=e.edgeRadius,b=e.maskOpacity,R=e.animatedComponent,w=e.animatedLineColor,C=e.animatedLineOrientation,v=e.animatedLineThickness,L=e.animationDuration,B=e.showAnimatedLine,k=e.runTimingFn,x=e.onLayoutChange,O=e.outerBoundingRect,W=e.onOuterLayout,E=n.useRef({topRight:{borderRightWidth:l,borderTopWidth:l,borderTopRightRadius:m,top:-l,right:-l},topLeft:{borderTopWidth:l,borderLeftWidth:l,borderTopLeftRadius:m,top:-l,left:-l},bottomRight:{borderBottomWidth:l,borderRightWidth:l,borderBottomRightRadius:m,bottom:-l,right:-l},bottomLeft:{borderBottomWidth:l,borderLeftWidth:l,borderBottomLeftRadius:m,bottom:-l,left:-l}}),T=function(e,t){var o,n=null!==(o=null==O?void 0:O[t])&&void 0!==o?o:0;return e?"number"==typeof e?.9*e:e.endsWith("%")?Number(e.split("%")[0])/100*(n||1)*.9:Number(e.split(/\d+/)[0])*(n||1)*.9:.9*n},V=function(e,t){return T(e,t)/.9-v},N=function(e){return n.createElement(t.View,{style:d({},{width:g,height:f,borderColor:h,zIndex:2},{},y[e],{},E.current[e])})},F=T(o,"width")/.9,j=T(i,"height")/.9;return n.createElement(t.View,{style:y.container},n.createElement(t.View,{onLayout:x||p,style:d({},y.finder,{width:F,height:j})},N("topLeft"),N("topRight"),N("bottomLeft"),N("bottomRight"),B?R?R(F,j):n.createElement(r.View,{style:function(){if("horizontal"===C){var e=T(o,"width"),t=V(i,"height");return d({},y.animatedLine,{height:v,width:e,backgroundColor:w,top:k(new c,a||0,u||t,L)})}var n=T(i,"height"),r=V(o,"width");return d({},y.animatedLine,{width:v,height:n,backgroundColor:w,left:k(new c,a||0,u||r,L)})}()}):null),n.createElement(t.View,{style:y.maskOuter,onLayout:W||p},n.createElement(t.View,{style:d({},y.maskRow,{},{backgroundColor:s,opacity:b,flex:1})}),n.createElement(t.View,{style:d({height:i},y.maskCenter)},n.createElement(t.View,{style:{backgroundColor:s,opacity:b,flex:1}}),n.createElement(t.View,{style:d({},y.maskInner,{width:o,height:i,borderRadius:m})}),n.createElement(t.View,{style:{backgroundColor:s,opacity:b,flex:1}})),n.createElement(t.View,{style:d({},y.maskRow,{},{backgroundColor:s,opacity:b,flex:1})})))}));b.defaultProps={width:280,height:230,edgeWidth:20,edgeHeight:20,edgeColor:"#fff",edgeBorderWidth:4,edgeRadius:0,backgroundColor:"#eee",maskOpacity:1,animatedLineColor:"#fff",animatedLineOrientation:"horizontal",animatedLineThickness:2,animationDuration:2e3,runTimingFn:function(e,t,o,n){var r={finished:new u(0),position:new u(t),time:new u(0),frameTime:new u(0)},a={duration:n,toValue:new u(o),easing:i.Easing.inOut(i.Easing.ease)};return s([f(e),g(e,r,a),l(r.finished,[h(r.finished,0),h(r.time,0),h(r.frameTime,0),h(r.position,l(m(r.position,o),o,t)),h(a.toValue,l(m(r.position,o),t,o))]),r.position])},showAnimatedLine:!0};var y=t.StyleSheet.create({container:d({alignItems:"center",justifyContent:"center"},t.StyleSheet.absoluteFillObject),finder:{alignItems:"center",justifyContent:"center",zIndex:1},maskOuter:{position:"absolute",top:0,left:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"space-around"},maskInner:{backgroundColor:"transparent"},maskRow:{width:"100%"},maskCenter:{flexDirection:"row",display:"flex"},topLeft:{position:"absolute",top:0,left:0},topRight:{position:"absolute",top:0,right:0},bottomLeft:{position:"absolute",bottom:0,left:0},bottomRight:{position:"absolute",bottom:0,right:0},animatedLine:{position:"absolute",zIndex:1}}),R=function(e){var t,i=e.displayName||e.name||"Component";return(t=function(t){var o,i;function r(){var e;return(e=t.apply(this,arguments)||this).state={boundingRect:{x:0,y:0,width:0,height:0}},e.onOuterLayout=function(t){e.setState({boundingRect:t.nativeEvent.layout})},e}return i=t,(o=r).prototype=Object.create(i.prototype),o.prototype.constructor=o,o.__proto__=i,r.prototype.render=function(){return n.createElement(e,Object.assign({outerBoundingRect:this.state.boundingRect,onOuterLayout:this.onOuterLayout},this.props))},r}(o.PureComponent)).displayName="withOuterLayout"+i,t},w=function(e,t,n){var i,r=o.useState(!1),a=r[0],u=r[1],c=o.useReducer((function(e,t){switch(t.type){case"SET":return d({},e,{},t.payload);default:return e}}),{width:0,height:0,x:0,y:0}),s=c[0],l=c[1],h=o.useCallback((function(e){var t=e.nativeEvent.layout;l({type:"SET",payload:{height:t.height,width:t.width,x:t.x,y:t.y}})}),[s.height,s.width,s.x,s.y]),f=0;return!n||n&&"number"==typeof n?(f&&clearTimeout(f),i=function(o){u(!0),t(e(o)),f=setTimeout((function(){u(!1)}),n)}):i=function(o){var i,r;null==n||null===(i=n.beforeScan)||void 0===i||i.call(n),t(e(o)),null==n||null===(r=n.afterScan)||void 0===r||r.call(n)},{barcodeRead:n&&"object"==typeof n?null:a,finderX:s.x,finderY:s.y,finderWidth:s.width,finderHeight:s.height,onBarcodeFinderLayoutChange:h,processingReadBarcode:i}},C=t.Platform.select({android:function(e,n,i,r,d,u,c){return o.useCallback((function(o){if(n&&!e){var s=o.bounds.origin.map((function(e){return{x:Number(e.x)/t.PixelRatio.get(),y:Number(e.y)/t.PixelRatio.get()}})),l=function(e){var t=e.x,o=e.y;return t>=i&&t<=i+d&&o>=r&&o<=r+u};if(o.type===a.RNCamera.Constants.BarCodeType.pdf417){var h=s[1],f=s[2],g=s[3];if(l(s[0])&&l(h)&&l(f)&&l(g))return void c(o.data)}if(o.type===a.RNCamera.Constants.BarCodeType.qr){var m=s[1],p=s[2],b=s[3];if(l(s[0])&&l(m)&&l(p)&&l(b))return void c(o.data)}}}),[e,n,i,r,d,u,c])},ios:function(e,t,n,i,r,a,d){return o.useCallback((function(o){if(t&&!e){var u=o.bounds,c=u.origin,s=c.x,l=c.y,h=u.size,f=h.width,g=h.height;return Number(s)>=n&&Number(s)+Number(f)<=n+r&&Number(l)>=i&&Number(l)+Number(g)<=i+a?d(o.data):void 0}}),[e,t,n,i,r,a,d])}}),v=t.Platform.select({android:function(e,t,o,n){void 0===n&&(n=500);var i=w(t,o,n),r=i.barcodeRead,a=i.onBarcodeFinderLayoutChange;return{barcodeRead:r,onBarcodeRead:C(null!=r&&r,e,i.finderX,i.finderY,i.finderWidth,i.finderHeight,i.processingReadBarcode),onBarcodeFinderLayoutChange:a}},ios:function(e,t,o,n){void 0===n&&(n=500);var i=w(t,o,n),r=i.barcodeRead,a=i.onBarcodeFinderLayoutChange;return{barcodeRead:r,onBarcodeRead:C(null!=r&&r,e,i.finderX,i.finderY,i.finderWidth,i.finderHeight,i.processingReadBarcode),onBarcodeFinderLayoutChange:a}}}),L=t.Platform.select({android:function(e,t,o,n,i){var r=w(t,o,n),a=r.barcodeRead,d=r.onBarcodeFinderLayoutChange,u=r.finderY,c=r.finderX,s=r.finderWidth,l=r.finderHeight,h=r.processingReadBarcode;return{barcodeRead:a,onBarcodeRead:i?i({x:c,y:u,width:s,height:l},h):C(null!=a&&a,e,c,u,s,l,h),onBarcodeFinderLayoutChange:d}},ios:function(e,t,o,n,i){var r=w(t,o,n),a=r.barcodeRead,d=r.onBarcodeFinderLayoutChange,u=r.finderHeight,c=r.finderWidth,s=r.finderX,l=r.finderY,h=r.processingReadBarcode;return{barcodeRead:a,onBarcodeRead:i?i({x:s,y:l,width:c,height:u},h):C(null!=a&&a,e,s,l,c,u,h),onBarcodeFinderLayoutChange:d}}}),B=R(b);exports.BarcodeMask=b,exports.BarcodeMaskWithOuterLayout=B,exports.useBarcodeRead=v,exports.useCustomBarcodeRead=L,exports.withOuterLayout=R;
//# sourceMappingURL=react-native-barcode-mask.cjs.production.min.js.map
